{% extends 'base.html' %}
{% block content %}
<style>
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
</style>

<!-- Hero Section -->
    <section class="bg-gradient-to-r from-yellow-99 to-yellow-99-light py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-4xl md:text-6xl font-bold text-black mb-4">
                    Sua comida favorita<br>
                    <span class="text-gray-800">entregue rapidinho</span>
                </h2>
                <p class="text-xl text-gray-800 mb-8 max-w-2xl mx-auto">
                    Descubra os melhores restaurantes da sua regi√£o e pe√ßa com facilidade
                </p>
                
                <!-- Location Input, autocomplete off para n√£o lembrar o que ja digitei e permanecer a sugest√£o no input-->
                <div class="max-w-md mx-auto relative">
                    <div class="flex">
                        <input id="busca-restaurante" type="text" autocomplete="off" placeholder="Buscar restaurantes ou pratos..."
                            class="flex-1 px-4 py-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-black">
                        <button id="btn-buscar" class="bg-black text-yellow-99 px-6 py-3 rounded-r-lg font-medium hover:bg-gray-800 transition duration-200">
                            Buscar
                        </button>
                    </div>
                    <!-- Dropdown de sugest√µes centralizado -->
                    <div id="sugestoes-restaurantes" class="absolute left-0 right-0 bg-white border border-gray-200 rounded-b-lg shadow-lg z-10 hidden w-full"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Carousel -->
<section class="py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h3 class="text-2xl font-bold text-gray-900 mb-8">Pedir seu delivery no iFome √© r√°pido e pr√°tico! Conhe√ßa as categorias</h3>
        <div class="relative">
            <!-- Bot√µes de navega√ß√£o -->
            <button id="cat-prev" class="absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white shadow rounded-full p-2 hidden md:block">
                <span class="text-2xl">&lt;</span>
            </button>
            <div id="categorias-carousel" class="flex overflow-x-auto gap-6 scrollbar-hide scroll-smooth py-2 px-1">
                <!-- Cada categoria -->
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">üáßüá∑</span>
                    </div>
                    <span class="text-gray-800 font-medium">Brasileira</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <a href="{{ url_for('restaurante.visualizar_cardapios') }}"></a>
                        <span class="text-3xl">üçï</span>
                    </div>
                    <span class="text-gray-800 font-medium">Pizza</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">üçî</span>
                    </div>
                    <span class="text-gray-800 font-medium">Lanches</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">üßÅ</span>
                    </div>
                    <span class="text-gray-800 font-medium">Doces e Bolos</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">üç£</span>
                    </div>
                    <span class="text-gray-800 font-medium">Japonesa</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">ü•ó</span>
                    </div>
                    <span class="text-gray-800 font-medium">Saud√°vel</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">üç±</span>
                    </div>
                    <span class="text-gray-800 font-medium">Marmitas</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">üçá</span>
                    </div>
                    <span class="text-gray-800 font-medium">A√ßa√≠</span>
                </div>
                <div class="flex-shrink-0 w-40 flex flex-col items-center bg-white p-4 rounded-lg shadow-md hover:bg-yellow-99/10 hover:scale-105 transition duration-200 cursor-pointer">
                    <div class="h-16 w-16 rounded-full flex items-center justify-center mb-2">
                        <span class="text-3xl">üç¶</span>
                    </div>
                    <span class="text-gray-800 font-medium">Sorvetes</span>
                </div>
            </div>
            <button id="cat-next" class="absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white shadow rounded-full p-2 hidden md:block">
                <span class="text-2xl">&gt;</span>
            </button>
        </div>
    </div>
</section>

    <!-- Restaurants -->
    <section class="py-12 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h3 class="text-2xl font-bold text-gray-900 mb-8">Lojas</h3>
            <div id="restaurantes-lista" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Restaurant Card 1 -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer">
                    <div class="h-48 bg-gradient-to-r from-red-400 to-red-600 flex items-center justify-center">
                        <span class="text-white text-6xl">üçï</span>
                    </div>
                    <div class="p-4">
                        <h4 class="text-lg font-semibold text-gray-900 mb-1">Pizzaria Bella</h4>
                        <p class="text-gray-600 text-sm mb-2">Pizza ‚Ä¢ Italiana</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="text-yellow-99 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                                <span class="text-gray-600 text-sm ml-1">(4.2)</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="bg-yellow-99 text-black px-2 py-1 rounded text-xs font-medium">25-35 min</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Restaurant Card 2 -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer">
                    <div class="h-48 bg-gradient-to-r from-orange-400 to-orange-600 flex items-center justify-center">
                        <span class="text-white text-6xl">üçî</span>
                    </div>
                    <div class="p-4">
                        <h4 class="text-lg font-semibold text-gray-900 mb-1">Burger House</h4>
                        <p class="text-gray-600 text-sm mb-2">Hamb√∫rguer ‚Ä¢ Lanches</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="text-yellow-99 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                                <span class="text-gray-600 text-sm ml-1">(4.8)</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="bg-yellow-99 text-black px-2 py-1 rounded text-xs font-medium">15-25 min</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Restaurant Card 3 -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer">
                    <div class="h-48 bg-gradient-to-r from-green-400 to-green-600 flex items-center justify-center">
                        <span class="text-white text-6xl">üç£</span>
                    </div>
                    <div class="p-4">
                        <h4 class="text-lg font-semibold text-gray-900 mb-1">Sushi Express</h4>
                        <p class="text-gray-600 text-sm mb-2">Japonesa ‚Ä¢ Sushi</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="text-yellow-99 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                                <span class="text-gray-600 text-sm ml-1">(4.5)</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="bg-yellow-99 text-black px-2 py-1 rounded text-xs font-medium">30-40 min</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Restaurant Card 4 -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer">
                    <div class="h-48 bg-gradient-to-r from-purple-400 to-purple-600 flex items-center justify-center">
                        <span class="text-white text-6xl">ü•ó</span>
                    </div>
                    <div class="p-4">
                        <h4 class="text-lg font-semibold text-gray-900 mb-1">Vida Saud√°vel</h4>
                        <p class="text-gray-600 text-sm mb-2">Saud√°vel ‚Ä¢ Saladas</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="text-yellow-99 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                                <span class="text-gray-600 text-sm ml-1">(4.3)</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="bg-yellow-99 text-black px-2 py-1 rounded text-xs font-medium">20-30 min</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Restaurant Card 5 -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer">
                    <div class="h-48 bg-gradient-to-r from-pink-400 to-pink-600 flex items-center justify-center">
                        <span class="text-white text-6xl">üç∞</span>
                    </div>
                    <div class="p-4">
                        <h4 class="text-lg font-semibold text-gray-900 mb-1">Doce Tenta√ß√£o</h4>
                        <p class="text-gray-600 text-sm mb-2">Doces ‚Ä¢ Sobremesas</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="text-yellow-99 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                                <span class="text-gray-600 text-sm ml-1">(4.9)</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="bg-yellow-99 text-black px-2 py-1 rounded text-xs font-medium">10-20 min</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Restaurant Card 6 -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer">
                    <div class="h-48 bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center">
                        <span class="text-white text-6xl">‚òï</span>
                    </div>
                    <div class="p-4">
                        <h4 class="text-lg font-semibold text-gray-900 mb-1">Caf√© Central</h4>
                        <p class="text-gray-600 text-sm mb-2">Bebidas ‚Ä¢ Caf√©</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <span class="text-yellow-99 text-sm">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                                <span class="text-gray-600 text-sm ml-1">(4.1)</span>
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="bg-yellow-99 text-black px-2 py-1 rounded text-xs font-medium">5-15 min</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        const inputBusca = document.getElementById('busca-restaurante');
        const sugestoesDiv = document.getElementById('sugestoes-restaurantes');

        // Dropdown de sugest√µes enquanto digita
        inputBusca.addEventListener('input', async function() {
            const termo = inputBusca.value.trim();
            if (termo.length === 0) {
                sugestoesDiv.classList.add('hidden');
                sugestoesDiv.innerHTML = '';
                return;
            }
            const res = await fetch(`/api/restaurantes/busca?q=${encodeURIComponent(termo)}`);
            const restaurantes = await res.json();

            if (restaurantes.length === 0) {
                sugestoesDiv.innerHTML = `<div class="px-4 py-2 text-gray-500">Nenhum restaurante encontrado.</div>`;
            } else {
                sugestoesDiv.innerHTML = restaurantes.map(r => `
                    <div class="px-4 py-2 hover:bg-yellow-99-light cursor-pointer border-b last:border-b-0" onclick="window.location.href='/restaurante/${r.id}'">
                        <div class="flex items-center gap-2">
                            ${r.imagem_restaurante ? 
                                `<img src="/static/${r.imagem_restaurante.replace(/^.*static[\\/]/, '')}" alt="Logo Restaurante" class="w-10 h-10 rounded-full object-cover border border-gray-300">`
                                : `<span class="text-xl">üçΩÔ∏è</span>`
                            }
                            <div>
                                <div class="font-semibold text-gray-800">${r.nome}</div>
                                <div class="text-xs text-gray-500">${r.categoria || ''}</div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            sugestoesDiv.classList.remove('hidden');
        });

        // Esconde o dropdown ao clicar fora
        document.addEventListener('click', function(e) {
            if (!inputBusca.contains(e.target) && !sugestoesDiv.contains(e.target)) {
                sugestoesDiv.classList.add('hidden');
            }
        });

        // Bot√£o buscar: mostra resultados completos nos cards
        document.getElementById('btn-buscar').addEventListener('click', function(e) {
            e.preventDefault();
            buscarRestaurantes();
        });

        // Fun√ß√£o para buscar e mostrar nos cards
        async function buscarRestaurantes() {
            const termo = document.getElementById('busca-restaurante').value;
            const res = await fetch(`/api/restaurantes/busca?q=${encodeURIComponent(termo)}`);
            const restaurantes = await res.json();
            const lista = document.getElementById('restaurantes-lista');
            lista.innerHTML = '';

            if (restaurantes.length === 0) {
                lista.innerHTML = '<div class="col-span-3 text-center text-gray-500">Nenhum restaurante encontrado.</div>';
                return;
            }

            restaurantes.forEach(r => {
                lista.innerHTML += `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-200 cursor-pointer">
                        <div class="h-48 bg-white flex items-center justify-center">
                            ${r.imagem_restaurante ? 
                                `<img src="/static/${r.imagem_restaurante.replace(/^.*static[\\/]/, '')}" alt="Logo Restaurante" class="w-40 h-40 rounded-full object-cover border border-gray-300">`
                                : `<span class="text-xl">üçΩÔ∏è</span>`
                            }
                        </div>
                        <div class="p-4">
                            <h4 class="text-lg font-semibold text-gray-900 mb-1">${r.nome}</h4>
                            <p class="text-gray-600 text-sm mb-2">${r.categoria}</p>
                        </div>
                    </div>
                `;
            });
        }

        // Carrossel simples para categorias
        const carousel = document.getElementById('categorias-carousel');
        document.getElementById('cat-prev').addEventListener('click', () => {
            carousel.scrollBy({ left: -200, behavior: 'smooth' });
        });
        document.getElementById('cat-next').addEventListener('click', () => {
            carousel.scrollBy({ left: 200, behavior: 'smooth' });
        });
    </script>

{% endblock content %}